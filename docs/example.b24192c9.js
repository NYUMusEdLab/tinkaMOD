parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"CZlB":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?n(e):r}function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Motor=exports.Color=exports.Distance=exports.Joystick=exports.Slider=exports.Knob=exports.Button=exports.TinkaTop=void 0;var a=function(){function t(){i(this,t),this.id=0,this.name="unsupported",this.return_types=["i"]}return c(t,[{key:"sense",value:function(t,e){return 0}},{key:"get_osc_args",value:function(t,e){var n=this.sense(t,e),r=[];if(!n&&0!==n)return!1;for(var o=0;o<this.return_types.length;o++)r.push({type:this.return_types[o],value:n[o]||n});return r}},{key:"get_id",value:function(){return this.id}},{key:"get_name",value:function(){return this.name}}]),t}();exports.TinkaTop=a;var f=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=1,t.name="button",t.return_types=["i"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){return e[0]}}]),n}();exports.Button=f;var l=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=2,t.name="knob",t.return_types=["f"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){return d(_(e),0,3.45,-10,10)}}]),n}();exports.Knob=l;var p=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=3,t.name="knob",t.return_types=["f"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){return d(255-e[0],0,255,0,10)}}]),n}();exports.Slider=p;var y=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=4,t.name="joystick",t.return_types=["f","f"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){var n=e[0],r=e[1],o=e[2]+e[3]/255;return[d(n+r/255,0,4,-10,10),-1*d(o,0,4,-10,10)]}}]),n}();exports.Joystick=y;var h=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=23,t.name="distance",t.return_types=["f"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){var n=_(e);return!(n>60)&&n}}]),n}();exports.Distance=h;var v=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=27,t.name="color",t.return_types=["i","i","i"],t}return o(n,a),c(n,[{key:"sense",value:function(t,e){var n=e[0],r=e[1],o=e[2];e[3];return!!(n+r+o)&&[n,r,o]}}]),n}();exports.Color=v;var b=function(t){function n(){var t;return i(this,n),(t=e(this,r(n).call(this))).id=5,t.name="motor",t.return_type=["i","f"],console.log("THIS WORKS"),t}return o(n,a),c(n,[{key:"sense",value:function(t,e){var n=e[0],r=_([e[1],e[2]]);if(0!=r)return[n,r]}},{key:"createSpeedMotorMessage",value:function(t,e,n){return new Uint8Array([90,171,10,0,0,2,5,0,0,t,e,n])}}]),n}();function _(t){if(2!=t.length)throw"Create Float function called on incorrect sensor.";return t[0]+t[1]/255}function d(t,e,n,r,o){var u=(t-e)*(o-r)/(n-e)+r;return u>o?o:u<r?r:u}exports.Motor=b;
},{}],"nOQX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TinkaCore=void 0;var e=require("./tinkatop.js");function n(e){return s(e)||r(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function s(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}var c=function(){function t(e,n){i(this,t),t.core_ids=t.core_ids||{connected:new Set([]),disconnected:new Set([])},t.number_added=t.number_added||0,t.eventTypes=["*","sensor change","reading","button","knob","slider","joystick","distance","color"],this.characteristics=n,this.id=e,this.number=t.number_added,this.name="tinka"+t.number_added,this.connected=!0,this.sensor_connected=!1,this.sensor=null,this.reading={},this.events=[],t.add_core(this.id)}return a(t,[{key:"connect",value:function(){var n=this;return n.who_am_i_handler=n.who_am_i.bind(n),n.characteristics[0].addEventListener("characteristicvaluechanged",n.who_am_i_handler),n.characteristics[0].startNotifications().then(function(t){var r=(new e.Motor).createSpeedMotorMessage(0,3,0);n.characteristics[1].writeValue(r)}),!0}},{key:"disconnect",value:function(){return this.connected=!1,t.remove_core(this.id),!1}},{key:"reconnect",value:function(e){return console.log("Reconnecting"),this.characteristics=e,t.add_core(this.id),this.connected=!0,this.connect(),!0}},{key:"connect_sensor",value:function(n){switch(n){case 1:this.sensor=new e.Button;break;case 2:this.sensor=new e.Knob;break;case 3:this.sensor=new e.Slider;break;case 4:this.sensor=new e.Joystick;break;case 5:this.sensor=new e.Motor;break;case 23:this.sensor=new e.Distance;break;case 27:this.sensor=new e.Color;break;default:this.sensor=new e.TinkaTop,console.log("not yet implemented")}return this.sensor_connected=!0,console.log("Sensor connected: ",this.sensor.name),this.sensor}},{key:"disconnect_sensor",value:function(){return this.sensor_connected=!1,this.sensor=null,console.log("Sensor disconnected"),!1}},{key:"parse_packet",value:function(e){var n=new Uint8Array(e.target.value.buffer);if(n.length<10)return console.log("Error: Invalid packet length; too short"),!1;n[2];var t=n[6],r=n[8],s=n.slice(9);switch(t){case 0:var i=s[0];255==i?this.disconnect_sensor():this.connect_sensor(i),this._callEventListeners({type:"sensor change",sensor:this.getSensorName(),value:this.sensor_connected,tinkacore:this});break;default:if(this.sensor_connected||this.connect_sensor(t),t!=this.sensor.id)this.connect_sensor(t);else{var o=this.sensor.sense(r,s);this.reading[this.sensor.name]=o,console.log(this.name+": "+this.getSensorName()+": ",o),this._callEventListeners({type:"reading",sensor:this.getSensorName(),value:o,tinkacore:this})}}}},{key:"getLastReading",value:function(e){return!!this.reading[e]&&this.reading[e]}},{key:"getSensorName",value:function(){return this.sensor_connected?this.sensor.name:"none"}},{key:"addEventListener",value:function(e,n){if("function"!=typeof n)throw"second argument must be a valid function";if(!t.eventTypes.includes(e))throw"event type must be valid";for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];var o={eventType:e,func:n,args:s};return this.events.push(o),!0}},{key:"removeEventListener",value:function(e,n){return this.events=this.events.filter(function(t){return t.eventType!=e||t.func!=n}),!0}},{key:"_callEventListeners",value:function(e){var t=!0,r=!1,s=void 0;try{for(var i,o=this.events[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;("*"==a.eventType||"reading"==a.eventType&&"reading"==e.type||a.eventType==e.sensor&&"reading"==e.type||"sensor change"==a.eventType&&"sensor change"==e.type)&&a.func.apply(a,[e].concat(n(a.args)))}}catch(c){r=!0,s=c}finally{try{t||null==o.return||o.return()}finally{if(r)throw s}}}},{key:"who_am_i",value:function(e){var n=!1,t=new Uint8Array(e.target.value.buffer);return 10==t.length?(console.log("Motor!"),n=!0):13==t.length&&(console.log("TinkaCore!"),t[6]=0,n=!0),n&&(this.parse_packet(e),this.characteristics[0].removeEventListener("characteristicvaluechanged",this.who_am_i_handler),this.characteristics[0].addEventListener("characteristicvaluechanged",this.parse_packet.bind(this))),n}}],[{key:"add_core",value:function(e){return t.core_ids.disconnected.has(e)?t.core_ids.disconnected.delete(e):t.number_added+=1,t.core_ids.connected.add(e),e}},{key:"remove_core",value:function(e){return t.core_ids.connected.delete(e),t.core_ids.disconnected.add(e),e}},{key:"createMessage",value:function(e,n,t){return new Uint8Array([90,171,10,0,0,2,5,0,0,e,n,t])}}]),t}();exports.TinkaCore=c;
},{"./tinkatop.js":"CZlB"}],"DZwl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./tinkacore.js");function n(e){return o(e)||r(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,n,t){return n&&c(e.prototype,n),t&&c(e,t),e}var s=function(){function t(){i(this,t),t.eventTypes=["*","connect","disconnect"],this.tinkacores={},this.serviceName=65530,this.events=[],e.TinkaCore.core_ids=e.TinkaCore.core_ids||{connected:new Set([]),disconnected:new Set([])}}return a(t,[{key:"connect",value:function(){var e,n=this,t=this;console.log("Requesting Bluetooth Device..."),navigator.bluetooth.requestDevice({filters:[{name:"Tinka"}],optionalServices:[t.serviceName]}).then(function(n){console.log("> Found "+n.name),console.log("> Id: "+n.id),console.log("> Connected: "+n.gatt.connected);var r=function(e){t._on_disconnected(e)}.bind(t);return n.addEventListener("gattserverdisconnected",r),e=n.id,n.gatt.connect()}).then(function(e){return console.log(e),e.getPrimaryService(t.serviceName)}).then(function(e){return console.log("Tinka services..."),console.log(e),e.getCharacteristics()}).then(function(n){return console.log("Tinka characteristics..."),t._add_tinkacore(e,n)}).then(function(e){n._callEventListeners({type:"connect",tinkacore:e,tinkamo:n}),console.log("Optional user callback")}).catch(function(e){console.log("Error",e)})}},{key:"addEventListener",value:function(e,n){if("function"!=typeof n)throw"second argument must be a valid function";if(!t.eventTypes.includes(e))throw"event type must be valid";for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var c={eventType:e,func:n,args:o};return this.events.push(c),!0}},{key:"removeEventListener",value:function(e,n){return this.events=this.events.filter(function(t){return t.eventType!=e||t.func!=n}),!0}},{key:"_callEventListeners",value:function(e){var t=!0,r=!1,o=void 0;try{for(var i,c=this.events[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var a=i.value;"*"!=a.eventType&&a.eventType!=e.type||a.func.apply(a,[e].concat(n(a.args)))}}catch(s){r=!0,o=s}finally{try{t||null==c.return||c.return()}finally{if(r)throw o}}}},{key:"getTinkamoList",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=Object.values(this.tinkacores);return n.sort(function(e,n){return e.number-n.number}),n.filter(function(n){return e||n.connected})}},{key:"getByID",value:function(e){return this.tinkacores[e]}},{key:"getByName",value:function(e){return Object.values(this.tinkacores).filter(function(n){return n.name==e})}},{key:"getBySensor",value:function(e){return Object.values(this.tinkacores).filter(function(n){return n.sensor.name==e})}},{key:"_add_tinkacore",value:function(n,t){if(e.TinkaCore.core_ids.disconnected.has(n))this.tinkacores[n].reconnect(t);else{var r=new e.TinkaCore(n,t);r.connect(),this.tinkacores[n]=r}return this.tinkacores[n]}},{key:"_on_disconnected",value:function(e){var n=e.target.id;this.tinkacores[n].disconnect(),this._callEventListeners({type:"disconnect",tinkacore:this.tinkacores[n],tinkamo:this})}}]),t}(),u=s;exports.default=u;
},{"./tinkacore.js":"nOQX"}],"Focm":[function(require,module,exports) {
"use strict";var e=n(require("../src/tinkamo.js"));function n(e){return e&&e.__esModule?e:{default:e}}var t,r=new e.default,i="Oops - Please make sure to connect a Tinkamo before trying one of the examples.",o=document.getElementById("connectionButton"),a=document.getElementById("example1"),l=document.getElementById("example2"),s=document.getElementById("example3"),c=document.getElementById("example4"),u=document.getElementById("example5"),m=document.getElementById("volume_slider"),d=!1;Tone.context.latencyHint="fastest";var v=new Tone.Volume(-100);v.mute=!0;var f=(new Tone.Synth).chain(v,Tone.Master),T=["F3","A3","A#3","C4","E4","F4","A4","A#4","C5","E5","F5"],g=new Tone.CtrlRandom({min:0,max:T.length,integer:!0});m.oninput=function(){-20==this.value?v.mute=!0:(v.mute=!1,v.volume.rampTo(this.value,.01))},r.addEventListener("connect",function(e){"tinka0"==e.tinkacore.name&&(t=e.tinkacore,e3(),e4(),e5()),o.className="waves-effect waves-light btn-large purple darken-1",o.innerHTML="<i class='material-icons left'>bluetooth_connected</i>Connect another one!"},o),r.addEventListener("disconnect",function(e){"tinka0"==e.tinkacore.name&&(o.className="waves-effect waves-light btn-large blue darken-1",o.innerHTML="<i class='material-icons left'>bluetooth</i>Connect your Tinkamo!")}),window.onConnectionCallback=function(){"running"!==Tone.context.state&&Tone.context.resume(),r.connect()},window.e1=function(){var e=r.getTinkamoList();if(!e.length)return alert(i),!1;for(var n in a.innerHTML="",e){var t=a.insertRow(n),o=t.insertCell(0),l=t.insertCell(1),s=t.insertCell(2);o.innerHTML=e[n].name,l.innerHTML=e[n].connected,s.innerHTML=e[n].getSensorName()}return!0},window.e2=function(){var e=r.getByName("tinka0");if(!e.length)return alert(i),!1;for(var n in l.innerHTML="",e){var t=l.insertRow(n),o=t.insertCell(0),a=t.insertCell(1),s=t.insertCell(2);o.innerHTML=e[n].name,a.innerHTML=e[n].connected,s.innerHTML=e[n].getSensorName()}return!0},window.e3=function(){t.addEventListener("sensor change",function(e){s.innerHTML="";var n=s.insertRow(0),t=n.insertCell(0),r=n.insertCell(1);t.innerHTML=e.value,r.innerHTML=e.sensor})},window.e4=function(){t.addEventListener("reading",function(e){c.innerHTML="";var n=c.insertRow(0),t=n.insertCell(0),r=n.insertCell(1);t.innerHTML=e.sensor,r.innerHTML=e.value})},window.e5=function(){t.addEventListener("button",function(e){if(e.value){var n=T[g.value];f.triggerAttack(n),u.innerHTML="button was pressed down"}else f.triggerRelease(),u.innerHTML="button was let up"})};
},{"../src/tinkamo.js":"DZwl"}]},{},["Focm"], null)
//# sourceMappingURL=/tinkaMOD/example.b24192c9.js.map